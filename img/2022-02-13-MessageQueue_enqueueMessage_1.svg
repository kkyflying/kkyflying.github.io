<svg id="SvgjsSvg1006" width="869" height="969" xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:svgjs="http://svgjs.com/svgjs"><defs id="SvgjsDefs1007"><marker id="SvgjsMarker1023" markerWidth="14" markerHeight="10" refX="10" refY="5" viewBox="0 0 14 10" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1024" d="M0,0 L14,5 L0,10 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker1083" markerWidth="14" markerHeight="10" refX="10" refY="5" viewBox="0 0 14 10" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1084" d="M0,0 L14,5 L0,10 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker1087" markerWidth="14" markerHeight="12" refX="16" refY="6" viewBox="0 0 14 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1088" d="M1,1 L14,6 L1,11L1,1" fill="#ffffff" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1091" markerWidth="14" markerHeight="10" refX="10" refY="5" viewBox="0 0 14 10" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1092" d="M0,0 L14,5 L0,10 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker1127" markerWidth="14" markerHeight="10" refX="10" refY="5" viewBox="0 0 14 10" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1128" d="M0,0 L14,5 L0,10 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker1131" markerWidth="14" markerHeight="12" refX="16" refY="6" viewBox="0 0 14 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1132" d="M1,1 L14,6 L1,11L1,1" fill="#ffffff" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1135" markerWidth="14" markerHeight="10" refX="10" refY="5" viewBox="0 0 14 10" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1136" d="M0,0 L14,5 L0,10 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker></defs><rect id="svgbackgroundid" width="869" height="969" fill="#ffffff"></rect><g id="SvgjsG1009" transform="translate(77,371)"><path id="SvgjsPath1010" d="M 0 0L 100 0L 100 70L 0 70Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1011"><text id="SvgjsText1012" font-family="微软雅黑" text-anchor="middle" font-size="19px" width="80px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="19px" weight="400" font-style="" opacity="1" y="20.625" transform="rotate(0)"><tspan id="SvgjsTspan1013" dy="23" x="50"><tspan id="SvgjsTspan1014" style="text-decoration:;">msg1</tspan></tspan></text></g></g><g id="SvgjsG1015" transform="translate(67,284)"><path id="SvgjsPath1016" d="M 0 0L 120 0L 120 40L 0 40Z" stroke="none" fill="none"></path><g id="SvgjsG1017"><text id="SvgjsText1018" font-family="微软雅黑" text-anchor="middle" font-size="21px" width="120px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="21px" weight="400" font-style="" opacity="1" y="2.375" transform="rotate(0)"><tspan id="SvgjsTspan1019" dy="26" x="60"><tspan id="SvgjsTspan1020" style="text-decoration:;">mMessages</tspan></tspan></text></g></g><g id="SvgjsG1021"><path id="SvgjsPath1022" d="M127 325L127 347.5L127 347.5L127 367.4" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1023)"></path></g><g id="SvgjsG1025" transform="translate(25,25)"><path id="SvgjsPath1026" d="M 0 0L 591 0L 591 38L 0 38Z" stroke="none" fill="none"></path><g id="SvgjsG1027"><text id="SvgjsText1028" font-family="微软雅黑" text-anchor="middle" font-size="18px" width="591px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="18px" weight="400" font-style="" opacity="1" y="5.25" transform="rotate(0)"><tspan id="SvgjsTspan1029" dy="22" x="295.5"><tspan id="SvgjsTspan1030" style="text-decoration:;">1. 当Message是第一条消息，或者是执行时间比mMessages还早的情况</tspan></tspan></text></g></g><g id="SvgjsG1031" transform="translate(49,259)"><path id="SvgjsPath1032" d="M 0 0L 752 0L 752 46L 0 46Z" stroke="none" fill="none"></path><g id="SvgjsG1033"><text id="SvgjsText1034" font-family="微软雅黑" text-anchor="middle" font-size="16px" width="752px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="16px" weight="400" font-style="" opacity="1" y="11" transform="rotate(0)"><tspan id="SvgjsTspan1035" dy="20" x="376"><tspan id="SvgjsTspan1036" style="text-decoration:;">1.1 设第一条消息msg1进来的时候，此时mMessages==null，即是p==null，因此把msg1插入链表的头部</tspan></tspan></text></g></g><g id="SvgjsG1037" transform="translate(48,70.5)"><path id="SvgjsPath1038" d="M 0 0L 470 0L 470 220.5L 0 220.5Z" stroke="none" fill="none"></path><g id="SvgjsG1039"><text id="SvgjsText1040" font-family="微软雅黑" text-anchor="start" font-size="20px" width="470px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="20px" weight="400" font-style="" opacity="1" y="-2.5" transform="rotate(0)"><tspan id="SvgjsTspan1041" dy="25" x="0"><tspan id="SvgjsTspan1042" style="text-decoration:;"> Message p = mMessages;</tspan></tspan><tspan id="SvgjsTspan1043" dy="25" x="0"><tspan id="SvgjsTspan1044" style="text-decoration:;"> if (p == null || when == 0 || when &lt; p.when) {</tspan></tspan><tspan id="SvgjsTspan1045" dy="25" x="0"><tspan id="SvgjsTspan1046" style="text-decoration:;">      //注释1</tspan></tspan><tspan id="SvgjsTspan1047" dy="25" x="0"><tspan id="SvgjsTspan1048" style="text-decoration:;">      // New head, wake up the event queue if blocked.</tspan></tspan><tspan id="SvgjsTspan1049" dy="25" x="0"><tspan id="SvgjsTspan1050" style="text-decoration:;">      msg.next = p;</tspan></tspan><tspan id="SvgjsTspan1051" dy="25" x="0"><tspan id="SvgjsTspan1052" style="text-decoration:;">      mMessages = msg;</tspan></tspan><tspan id="SvgjsTspan1053" dy="25" x="0"><tspan id="SvgjsTspan1054" style="text-decoration:;">      needWake = mBlocked;</tspan></tspan><tspan id="SvgjsTspan1055" dy="25" x="0"><tspan id="SvgjsTspan1056" style="text-decoration:;">}</tspan></tspan></text></g></g><g id="SvgjsG1057" transform="translate(49,475)"><path id="SvgjsPath1058" d="M 0 0L 795 0L 795 30L 0 30Z" stroke="none" fill="none"></path><g id="SvgjsG1059"><text id="SvgjsText1060" font-family="微软雅黑" text-anchor="middle" font-size="16px" width="795px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="16px" weight="400" font-style="" opacity="1" y="3" transform="rotate(0)"><tspan id="SvgjsTspan1061" dy="20" x="397.5"><tspan id="SvgjsTspan1062" style="text-decoration:;">1.2 设一条新消息msg2进来的时候，此时when==0，即是这条msg2需要立马执行，因此把msg2插入链表的头部；</tspan></tspan></text></g></g><g id="SvgjsG1063" transform="translate(233,598)"><path id="SvgjsPath1064" d="M 0 0L 100 0L 100 70L 0 70Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1065"><text id="SvgjsText1066" font-family="微软雅黑" text-anchor="middle" font-size="19px" width="80px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="19px" weight="400" font-style="" opacity="1" y="20.625" transform="rotate(0)"><tspan id="SvgjsTspan1067" dy="23" x="50"><tspan id="SvgjsTspan1068" style="text-decoration:;">msg1</tspan></tspan></text></g></g><g id="SvgjsG1069" transform="translate(49,508)"><path id="SvgjsPath1070" d="M 0 0L 120 0L 120 40L 0 40Z" stroke="none" fill="none"></path><g id="SvgjsG1071"><text id="SvgjsText1072" font-family="微软雅黑" text-anchor="middle" font-size="21px" width="120px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="21px" weight="400" font-style="" opacity="1" y="2.375" transform="rotate(0)"><tspan id="SvgjsTspan1073" dy="26" x="60"><tspan id="SvgjsTspan1074" style="text-decoration:;">mMessages</tspan></tspan></text></g></g><g id="SvgjsG1075" transform="translate(59,598)"><path id="SvgjsPath1076" d="M 0 0L 100 0L 100 70L 0 70Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1077"><text id="SvgjsText1078" font-family="微软雅黑" text-anchor="middle" font-size="19px" width="80px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="19px" weight="400" font-style="" opacity="1" y="20.625" transform="rotate(0)"><tspan id="SvgjsTspan1079" dy="23" x="50"><tspan id="SvgjsTspan1080" style="text-decoration:;">msg2</tspan></tspan></text></g></g><g id="SvgjsG1081"><path id="SvgjsPath1082" d="M109 549L109 573L109 573L109 594.4" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1083)"></path></g><g id="SvgjsG1085"><path id="SvgjsPath1086" d="M170 528L283 528L283 594.4" stroke-dasharray="8,5" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1087)"></path></g><g id="SvgjsG1089"><path id="SvgjsPath1090" d="M160 633L196 633L196 633L229.4 633" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1091)"></path></g><g id="SvgjsG1093" transform="translate(135,604)"><path id="SvgjsPath1094" d="M 0 0L 120 0L 120 40L 0 40Z" stroke="none" fill="none"></path><g id="SvgjsG1095"><text id="SvgjsText1096" font-family="微软雅黑" text-anchor="middle" font-size="20px" width="120px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="20px" weight="400" font-style="" opacity="1" y="5" transform="rotate(0)"><tspan id="SvgjsTspan1097" dy="25" x="60"><tspan id="SvgjsTspan1098" style="text-decoration:;">next</tspan></tspan></text></g></g><g id="SvgjsG1099" transform="translate(35,732)"><path id="SvgjsPath1100" d="M 0 0L 809 0L 809 37L 0 37Z" stroke="none" fill="none"></path><g id="SvgjsG1101"><text id="SvgjsText1102" font-family="微软雅黑" text-anchor="start" font-size="16px" width="809px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="16px" weight="400" font-style="" opacity="1" y="-3.5" transform="rotate(0)"><tspan id="SvgjsTspan1103" dy="20" x="0"><tspan id="SvgjsTspan1104" style="text-decoration:;">1.3 设一条新消息msg3进来的时候，此时when&lt;p.when，即是这条msg3比目前在链表头部msg的执行时间更早，因此</tspan></tspan><tspan id="SvgjsTspan1105" dy="20" x="0"><tspan id="SvgjsTspan1106" style="text-decoration:;">把msg2插入链表的头部；</tspan></tspan></text></g></g><g id="SvgjsG1107" transform="translate(244,874)"><path id="SvgjsPath1108" d="M 0 0L 100 0L 100 70L 0 70Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1109"><text id="SvgjsText1110" font-family="微软雅黑" text-anchor="middle" font-size="19px" width="80px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="19px" weight="400" font-style="" opacity="1" y="20.625" transform="rotate(0)"><tspan id="SvgjsTspan1111" dy="23" x="50"><tspan id="SvgjsTspan1112" style="text-decoration:;">msg1</tspan></tspan></text></g></g><g id="SvgjsG1113" transform="translate(59,784)"><path id="SvgjsPath1114" d="M 0 0L 120 0L 120 40L 0 40Z" stroke="none" fill="none"></path><g id="SvgjsG1115"><text id="SvgjsText1116" font-family="微软雅黑" text-anchor="middle" font-size="21px" width="120px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="21px" weight="400" font-style="" opacity="1" y="2.375" transform="rotate(0)"><tspan id="SvgjsTspan1117" dy="26" x="60"><tspan id="SvgjsTspan1118" style="text-decoration:;">mMessages</tspan></tspan></text></g></g><g id="SvgjsG1119" transform="translate(69,874)"><path id="SvgjsPath1120" d="M 0 0L 100 0L 100 70L 0 70Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1121"><text id="SvgjsText1122" font-family="微软雅黑" text-anchor="middle" font-size="19px" width="80px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="19px" weight="400" font-style="" opacity="1" y="20.625" transform="rotate(0)"><tspan id="SvgjsTspan1123" dy="23" x="50"><tspan id="SvgjsTspan1124" style="text-decoration:;">msg3</tspan></tspan></text></g></g><g id="SvgjsG1125"><path id="SvgjsPath1126" d="M119 825L119 849L119 849L119 870.4" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1127)"></path></g><g id="SvgjsG1129"><path id="SvgjsPath1130" d="M180 804L294 804L294 870.4" stroke-dasharray="8,5" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1131)"></path></g><g id="SvgjsG1133"><path id="SvgjsPath1134" d="M170 909L206.5 909L206.5 909L240.39999999999998 909" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1135)"></path></g><g id="SvgjsG1137" transform="translate(145,880)"><path id="SvgjsPath1138" d="M 0 0L 120 0L 120 40L 0 40Z" stroke="none" fill="none"></path><g id="SvgjsG1139"><text id="SvgjsText1140" font-family="微软雅黑" text-anchor="middle" font-size="20px" width="120px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="20px" weight="400" font-style="" opacity="1" y="5" transform="rotate(0)"><tspan id="SvgjsTspan1141" dy="25" x="60"><tspan id="SvgjsTspan1142" style="text-decoration:;">next</tspan></tspan></text></g></g></svg>