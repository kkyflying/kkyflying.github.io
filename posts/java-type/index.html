<!DOCTYPE html><html lang="en-US" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="pv-cache-enabled" content="false"><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="java基本类型的理解" /><meta name="author" content="kky" /><meta property="og:locale" content="en_US" /><meta name="description" content="前提补充" /><meta property="og:description" content="前提补充" /><link rel="canonical" href="https://kkyflying.github.io/posts/java-type/" /><meta property="og:url" content="https://kkyflying.github.io/posts/java-type/" /><meta property="og:site_name" content="kky" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-01-04T23:40:24+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="java基本类型的理解" /><meta name="twitter:site" content="@twitter_username" /><meta name="twitter:creator" content="@kky" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"kky"},"dateModified":"2023-01-04T23:40:24+08:00","datePublished":"2023-01-04T23:40:24+08:00","description":"前提补充","headline":"java基本类型的理解","mainEntityOfPage":{"@type":"WebPage","@id":"https://kkyflying.github.io/posts/java-type/"},"url":"https://kkyflying.github.io/posts/java-type/"}</script><title>java基本类型的理解 | kky</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/favicons/icon.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">kky</a></div><div class="site-subtitle font-italic">芜湖，起飞～</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/kkyflying" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['kkyflying','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>java基本类型的理解</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>java基本类型的理解</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Wed, Jan 4, 2023, 11:40 PM +0800" > Jan 4, 2023 <i class="unloaded">2023-01-04T23:40:24+08:00</i> </span> by <span class="author"> kky </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="3247 words">18 min</span></div></div><div class="post-content"><h2 id="前提补充">前提补充</h2><ol><li><strong>位移运算计算机中存的都是数的补码，所以位移运算都是对补码而言的</strong><li>左移<code class="language-plaintext highlighter-rouge">&lt;&lt;</code> ， 右补0<li>有符号右移<code class="language-plaintext highlighter-rouge">&gt;&gt;</code> 左补符号位，即：如果符号位是1 就左补1，如果符号位是0 就左补0<li>无符号右移<code class="language-plaintext highlighter-rouge">&gt;&gt;&gt;</code> ，统一左补0<li>原码反码补码关系<ul><li>正数下，原码=反码=补码<li>负数下，原码=反码除符号位不变，其余全部取反,补码=反码+1</ul><li>计算机中统一用补码的原因<ul><li>使用补码，可以将符号位和其它位统一处理<li>减法也可按加法来处理</ul><li>Java语言提供了八种基本类型<ul><li>整数型 byte , short , int ,long<li>浮点型 float ，double<li>字符型 char<li>布尔型 boolean</ul></ol><h3 id="1-byte">1. byte</h3><ol><li>长度8位,有符号的<li>最大127（2<sup>7</sup>-1），最小-128（-2<sup>7</sup>）<div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">byte</span>   <span class="no">MIN_VALUE</span> <span class="o">=</span> <span class="o">-</span><span class="mi">128</span><span class="o">;</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">byte</span>   <span class="no">MAX_VALUE</span> <span class="o">=</span> <span class="mi">127</span><span class="o">;</span>
</pre></table></code></div></div></ol><h4 id="如果超过byte的范围的情况下">如果超过byte的范围的情况下</h4><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="kt">int</span> <span class="n">i1</span> <span class="o">=</span> <span class="mi">1234</span><span class="o">;</span>
<span class="kt">byte</span> <span class="n">b1</span> <span class="o">=</span> <span class="o">(</span><span class="kt">byte</span><span class="o">)</span> <span class="n">i1</span><span class="o">;</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"i1="</span><span class="o">+</span><span class="n">i1</span><span class="o">);</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"b1="</span><span class="o">+</span><span class="n">b1</span><span class="o">);</span>

<span class="kt">int</span> <span class="n">i2</span> <span class="o">=</span> <span class="mi">2167</span><span class="o">;</span>
<span class="kt">byte</span> <span class="n">b2</span> <span class="o">=</span> <span class="o">(</span><span class="kt">byte</span><span class="o">)</span> <span class="n">i2</span><span class="o">;</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"i2="</span><span class="o">+</span><span class="n">i2</span><span class="o">);</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"b2="</span><span class="o">+</span><span class="n">b2</span><span class="o">);</span>
</pre></table></code></div></div><p>输出结果如下：</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>i1=1234
b1=-46
i2=2167
b2=119
</pre></table></code></div></div><p>实际上就是把i1强制类型转换到byte类型，而int是32位，byte仅有8位，<strong>因此byte获得是int的低8位</strong>,把十进制1234转换成二进制如下</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>dec = 1234
bin = 0000 0000 0000 0000 0000 0100 1101 0010 
</pre></table></code></div></div><p>按照byte获得低8位来规则来看，而byte的最高位是符号位，最高位是1，为负数，并二进制补码表示的整数，原码取反得反码再加1得到补码</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>1. 低八位 1101 0010
2. 取反码 1010 1101 
3. 取补码 1010 1110
4. 1010 1110首位是符号位，首位是符号位等于1为负数，把010 1110转成十进制就是46
5. 最后得到b1打印出来是-46
</pre></table></code></div></div><p>再来看一下b2</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>dec = 2167
bin = 0000 0000 0000 0000 0000 1000 0111 0111‬
</pre></table></code></div></div><p>同样的是先取低8位，首位是0，为正数，那么原码等于反码等于补码</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>1. 低八位 0111 0111
2. 取反码 0111 0111
3. 取补码 0111 0111
4. 最后b2打印出来就是119
</pre></table></code></div></div><h3 id="2-int">2. int</h3><ol><li>长度32位,有符号的<li>最小值0x80000000(-2<sup>31</sup>)，最大值0x7fffffff(2<sup>31</sup>-1)<div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span>   <span class="no">MIN_VALUE</span> <span class="o">=</span> <span class="mh">0x80000000</span><span class="o">;</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span>   <span class="no">MAX_VALUE</span> <span class="o">=</span> <span class="mh">0x7fffffff</span><span class="o">;</span>
</pre></table></code></div></div><h4 id="把int类型通过byte保存">把int类型通过byte保存</h4><p>int是32位，需要4个byte来保存，那么通过用byte数组分别保存一个int的数据，通过上面的分析，byte保存int的低8位，那么通过右移符把要需要保存的部分移动到低8位即可，然后通过左移符把byte移回到原来的位置，还原int的数据， 代码如下</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre>        <span class="kd">final</span> <span class="kt">int</span> <span class="n">i3</span> <span class="o">=</span> <span class="mi">1281231275</span><span class="o">;</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="nc">Integer</span><span class="o">.</span><span class="na">toBinaryString</span><span class="o">(</span><span class="n">i3</span><span class="o">));</span>
        <span class="kt">byte</span><span class="o">[]</span> <span class="n">buff</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="mi">4</span><span class="o">];</span>
        <span class="n">buff</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="o">=</span> <span class="o">(</span><span class="kt">byte</span><span class="o">)</span> <span class="n">i3</span> <span class="o">;</span>
        <span class="n">buff</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span> <span class="o">=</span> <span class="o">(</span><span class="kt">byte</span><span class="o">)</span> <span class="o">(</span><span class="n">i3</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span><span class="o">);</span>
        <span class="n">buff</span><span class="o">[</span><span class="mi">2</span><span class="o">]</span> <span class="o">=</span> <span class="o">(</span><span class="kt">byte</span><span class="o">)</span> <span class="o">(</span><span class="n">i3</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span><span class="o">);</span>
        <span class="n">buff</span><span class="o">[</span><span class="mi">3</span><span class="o">]</span> <span class="o">=</span> <span class="o">(</span><span class="kt">byte</span><span class="o">)</span> <span class="o">(</span><span class="n">i3</span> <span class="o">&gt;&gt;</span> <span class="mi">24</span><span class="o">);</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span> <span class="n">buff</span><span class="o">.</span><span class="na">length</span><span class="o">-</span><span class="mi">1</span><span class="o">;</span> <span class="n">i</span> <span class="o">&gt;=</span><span class="mi">0</span> <span class="o">;</span><span class="n">i</span><span class="o">--</span> <span class="o">){</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span> <span class="n">buff</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">+</span><span class="s">" "</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">""</span><span class="o">);</span>
        <span class="kt">int</span> <span class="n">i3b</span> <span class="o">=</span> <span class="o">(</span><span class="n">buff</span><span class="o">[</span><span class="mi">3</span><span class="o">]</span> <span class="o">&lt;&lt;</span> <span class="mi">24</span> <span class="o">)</span> <span class="o">+</span>
                  <span class="o">(</span><span class="n">buff</span><span class="o">[</span><span class="mi">2</span><span class="o">]</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span> <span class="o">)</span> <span class="o">+</span>
                  <span class="o">(</span><span class="n">buff</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span>  <span class="o">)</span> <span class="o">+</span>
                  <span class="o">(</span><span class="n">buff</span><span class="o">[</span><span class="mi">0</span><span class="o">]);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="nc">Integer</span><span class="o">.</span><span class="na">toBinaryString</span><span class="o">(</span><span class="n">i3b</span><span class="o">));</span>
</pre></table></code></div></div><p>输出结果和预期是一样的</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>1001100010111100000100110101011
76 94 9 -85 
1001100010111100000100110101011
</pre></table></code></div></div><p>那么当int的是负数的情况下，用如上代码，把i3改成-9，那么以下的输出的结果明显不对</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>11111111111111111111111111110111
-1 -1 -1 -9 
11111110111111101111111011110111
</pre></table></code></div></div><p>先来计算下当int i3 = -9的时候二进制的表示</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>原码 1000 0000 0000 0000 0000 0000 0000 1001
反码 1111 1111 1111 1111 1111 1111 1111 0110
补码 1111 1111 1111 1111 1111 1111 1111 0111
</pre></table></code></div></div><p>这个时候，只右移动到低8位转成byte保存情况下，</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>1111 1111 
1111 1111 
1111 1111 
1111 0111 
</pre></table></code></div></div><p>这个时候把1111 0111和1111 1111转回原码分别为1000 1001和1000 0001,和再转换成十进制就和打印出来的一样-9和-1</p></ol><p>再举例说明，如下</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>byte a = -1; //原码1000 0001 -&gt;反码 1111 1110 -&gt;  补码1111 1111
int i = a;
int i2 = i &lt;&lt; 8;
System.out.println(Integer.toBinaryString(i));
System.out.println(Integer.toBinaryString(i2));
System.out.println(i2);
</pre></table></code></div></div><p>输出结果</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>11111111111111111111111111111111
11111111111111111111111100000000
-256
</pre></table></code></div></div><p>再把修改a=1;输出结果</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>1
100000000
256
</pre></table></code></div></div><ol><li><strong>当byte是负数的时候转成int，jvm会在左边自动用1补位，当为正数的时候，jvm会在左边自动用0补位</strong><li>虽然从byte转成int的时候是可以保证十进制的一致性，毕竟int的有效范围比byte更大，但现在我们要是保证在<strong>内存中补码的一致性</strong>，才能把int转成byte再还原，而在byte是负数的情况下，左移后的，右边补0，再转成int，左边补1，这里就已经改变了补码了，最后4个byte相加，必然不能得到原来的int</ol><p>那么正确的做法如下：</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
</pre><td class="rouge-code"><pre>        <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
            <span class="kd">final</span> <span class="kt">int</span> <span class="n">i3</span> <span class="o">=</span> <span class="o">-</span><span class="mi">9</span><span class="o">;</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">add0to32</span> <span class="o">(</span><span class="nc">Integer</span><span class="o">.</span><span class="na">toBinaryString</span><span class="o">(</span><span class="n">i3</span><span class="o">)</span> <span class="o">));</span>
            <span class="kt">byte</span><span class="o">[]</span> <span class="n">buff</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="mi">4</span><span class="o">];</span>
            <span class="n">buff</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="o">=</span> <span class="o">(</span><span class="kt">byte</span><span class="o">)</span> <span class="n">i3</span> <span class="o">;</span>
            <span class="n">buff</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span> <span class="o">=</span> <span class="o">(</span><span class="kt">byte</span><span class="o">)</span> <span class="o">(</span><span class="n">i3</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span> <span class="o">);</span>
            <span class="n">buff</span><span class="o">[</span><span class="mi">2</span><span class="o">]</span> <span class="o">=</span> <span class="o">(</span><span class="kt">byte</span><span class="o">)</span> <span class="o">(</span><span class="n">i3</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span> <span class="o">);</span>
            <span class="n">buff</span><span class="o">[</span><span class="mi">3</span><span class="o">]</span> <span class="o">=</span> <span class="o">(</span><span class="kt">byte</span><span class="o">)</span> <span class="o">(</span><span class="n">i3</span> <span class="o">&gt;&gt;</span> <span class="mi">24</span> <span class="o">);</span>
            <span class="kt">int</span> <span class="n">b3</span> <span class="o">=</span> <span class="o">(</span><span class="n">buff</span><span class="o">[</span><span class="mi">3</span><span class="o">]</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="o">)</span> <span class="o">&lt;&lt;</span> <span class="mi">24</span><span class="o">;</span>
            <span class="kt">int</span> <span class="n">b2</span> <span class="o">=</span> <span class="o">(</span><span class="n">buff</span><span class="o">[</span><span class="mi">2</span><span class="o">]</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="o">)</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="o">;</span>
            <span class="kt">int</span> <span class="n">b1</span> <span class="o">=</span> <span class="o">(</span><span class="n">buff</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="o">)</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="o">;</span>
            <span class="kt">int</span> <span class="n">b0</span> <span class="o">=</span> <span class="o">(</span><span class="n">buff</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="o">)</span> <span class="o">;</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">add0to32</span> <span class="o">(</span> <span class="nc">Integer</span><span class="o">.</span><span class="na">toBinaryString</span><span class="o">(</span><span class="n">b3</span><span class="o">)</span> <span class="o">));</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">add0to32</span> <span class="o">(</span> <span class="nc">Integer</span><span class="o">.</span><span class="na">toBinaryString</span><span class="o">(</span><span class="n">b2</span><span class="o">)</span> <span class="o">));</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">add0to32</span> <span class="o">(</span> <span class="nc">Integer</span><span class="o">.</span><span class="na">toBinaryString</span><span class="o">(</span><span class="n">b1</span><span class="o">)</span> <span class="o">));</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">add0to32</span> <span class="o">(</span> <span class="nc">Integer</span><span class="o">.</span><span class="na">toBinaryString</span><span class="o">(</span><span class="n">b0</span><span class="o">)</span> <span class="o">));</span>
            <span class="kt">int</span> <span class="n">i3b</span> <span class="o">=</span> <span class="n">b3</span><span class="o">+</span> <span class="n">b2</span> <span class="o">+</span> <span class="n">b1</span> <span class="o">+</span> <span class="n">b0</span> <span class="o">;</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">add0to32</span> <span class="o">(</span> <span class="nc">Integer</span><span class="o">.</span><span class="na">toBinaryString</span><span class="o">(</span><span class="n">i3b</span><span class="o">)</span> <span class="o">));</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">i3b</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="kd">private</span> <span class="kd">static</span> <span class="nc">String</span> <span class="nf">add0to32</span><span class="o">(</span><span class="nc">String</span> <span class="n">s</span><span class="o">){</span>
            <span class="nc">StringBuffer</span> <span class="n">buffer</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">StringBuffer</span><span class="o">();</span>
            <span class="k">if</span><span class="o">(</span><span class="mi">32</span><span class="o">&gt;</span><span class="n">s</span><span class="o">.</span><span class="na">length</span><span class="o">()){</span>
                <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">last</span><span class="o">=</span><span class="mi">0</span> <span class="o">;</span>  <span class="n">last</span> <span class="o">&lt;</span> <span class="mi">32</span><span class="o">-</span><span class="n">s</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">;</span> <span class="n">last</span><span class="o">++){</span>
                    <span class="n">buffer</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">"0"</span><span class="o">);</span>
                <span class="o">}</span>
            <span class="o">}</span>
            <span class="nc">String</span> <span class="n">a</span> <span class="o">=</span> <span class="n">buffer</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">s</span><span class="o">).</span><span class="na">toString</span><span class="o">();</span>
            <span class="nc">StringBuffer</span> <span class="n">buffer1</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">StringBuffer</span><span class="o">();</span>
            <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">index</span><span class="o">=</span><span class="mi">0</span> <span class="o">;</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="mi">8</span> <span class="o">;</span> <span class="n">index</span><span class="o">++){</span>
                <span class="n">buffer1</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">a</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="n">index</span><span class="o">*</span><span class="mi">4</span><span class="o">,</span><span class="n">index</span><span class="o">*</span><span class="mi">4</span><span class="o">+</span><span class="mi">4</span><span class="o">)</span> <span class="o">+</span> <span class="s">" "</span><span class="o">);</span>
            <span class="o">}</span>
            <span class="k">return</span>  <span class="n">buffer1</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>
        <span class="o">}</span>
</pre></table></code></div></div><p>输出结果如下</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>    1111 1111 1111 1111 1111 1111 1111 0111 
    1111 1111 0000 0000 0000 0000 0000 0000 
    0000 0000 1111 1111 0000 0000 0000 0000 
    0000 0000 0000 0000 1111 1111 0000 0000 
    0000 0000 0000 0000 0000 0000 1111 0111 
    1111 1111 1111 1111 1111 1111 1111 0111 
    -9
</pre></table></code></div></div><ol><li><strong>重点在于左移前进行&amp;0xff操作</strong>，初看0xff就8位，然而0xff大于byte的范围了，当<code class="language-plaintext highlighter-rouge">int b0 = (buff[0] &amp; 0xff);</code>的时候，0xff就是一个int类型并且把buff[0]转成int，实际计算如下<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>1111 1111 1111 1111 1111 1111 1111 0111 
&amp;
0000 0000 0000 0000 0000 0000 1111 1111
=
0000 0000 0000 0000 0000 0000 1111 0111
</pre></table></code></div></div><p>这个&amp;0xff就是类似于substring的操作，截取了低8位，左边全部都是补0，就一个整数，在左移后，还不够32位，左边也是补0，保证了补码二进制的一致性，最后四个byte加一起就能还原int</p></ol><h3 id="3-long">3. long</h3><ol><li>64位，有符号<li>最大值2<sup>63</sup>-1,最小值-2<sup>63</sup><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="no">MIN_VALUE</span> <span class="o">=</span> <span class="mh">0x8000000000000000</span><span class="no">L</span><span class="o">;</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="no">MAX_VALUE</span> <span class="o">=</span> <span class="mh">0x7fffffffffffffff</span><span class="no">L</span><span class="o">;</span>
</pre></table></code></div></div></ol><h4 id="把long类型通过byte保存">把long类型通过byte保存</h4><p>思路上和int类型通过byte保存时候一样的，但是有些小细节，long是64位，所以byte数组的长度得是8，在进行<code class="language-plaintext highlighter-rouge">buff[index]&amp;0xff</code>这一步的时候，要在0xff前加上(long)进行强制类型转换，因为0xff默认是int类型，如果对<code class="language-plaintext highlighter-rouge">buff[index]&amp;0xff</code>强制类型转换成long，当是负数的时候，就不能保证补码的一致性了</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre><td class="rouge-code"><pre>    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">final</span> <span class="kt">long</span> <span class="n">i3</span> <span class="o">=</span> <span class="mi">8991123123123123123L</span><span class="o">;</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="nc">Long</span><span class="o">.</span><span class="na">toBinaryString</span><span class="o">(</span><span class="n">i3</span><span class="o">));</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">add0to64</span><span class="o">(</span><span class="nc">Long</span><span class="o">.</span><span class="na">toBinaryString</span><span class="o">(</span><span class="n">i3</span><span class="o">)));</span>
        <span class="kt">byte</span><span class="o">[]</span> <span class="n">buff</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="mi">8</span><span class="o">];</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="mi">0</span> <span class="o">;</span><span class="n">index</span> <span class="o">&lt;</span><span class="mi">8</span><span class="o">;</span> <span class="n">index</span><span class="o">++){</span>
            <span class="n">buff</span><span class="o">[</span><span class="n">index</span><span class="o">]</span> <span class="o">=</span> <span class="o">(</span><span class="kt">byte</span><span class="o">)</span> <span class="o">(</span><span class="n">i3</span> <span class="o">&gt;&gt;</span> <span class="o">(</span><span class="n">index</span><span class="o">*</span><span class="mi">8</span><span class="o">));</span>
        <span class="o">}</span>
        <span class="kt">long</span> <span class="n">toto</span> <span class="o">=</span> <span class="mi">0L</span><span class="o">;</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="mi">7</span> <span class="o">;</span><span class="n">index</span> <span class="o">&gt;=</span><span class="mi">0</span><span class="o">;</span> <span class="n">index</span><span class="o">--){</span>
            <span class="c1">//注意这里，先把0xff先强制类型转换成long</span>
            <span class="kt">long</span> <span class="n">l</span> <span class="o">=</span> <span class="o">(</span><span class="n">buff</span><span class="o">[</span><span class="n">index</span><span class="o">]</span> <span class="o">&amp;</span>  <span class="o">(</span><span class="kt">long</span><span class="o">)</span><span class="mh">0xff</span><span class="o">)</span>  <span class="o">&lt;&lt;</span> <span class="o">(</span><span class="n">index</span> <span class="o">*</span> <span class="mi">8</span><span class="o">);</span>
            <span class="n">toto</span> <span class="o">=</span> <span class="n">toto</span> <span class="o">+</span><span class="n">l</span><span class="o">;</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span> <span class="n">add0to64</span><span class="o">(</span><span class="nc">Long</span><span class="o">.</span><span class="na">toBinaryString</span><span class="o">(</span><span class="n">l</span><span class="o">)));</span>
        <span class="o">}</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">toto</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="nc">String</span> <span class="nf">add0to64</span><span class="o">(</span><span class="nc">String</span> <span class="n">s</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">StringBuffer</span> <span class="n">buffer</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">StringBuffer</span><span class="o">();</span>
        <span class="k">if</span> <span class="o">(</span><span class="mi">64</span> <span class="o">&gt;</span> <span class="n">s</span><span class="o">.</span><span class="na">length</span><span class="o">())</span> <span class="o">{</span>
            <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">last</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">last</span> <span class="o">&lt;</span> <span class="mi">64</span> <span class="o">-</span> <span class="n">s</span><span class="o">.</span><span class="na">length</span><span class="o">();</span> <span class="n">last</span><span class="o">++)</span> <span class="o">{</span>
                <span class="n">buffer</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">"0"</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="nc">String</span> <span class="n">a</span> <span class="o">=</span> <span class="n">buffer</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">s</span><span class="o">).</span><span class="na">toString</span><span class="o">();</span>
        <span class="nc">StringBuffer</span> <span class="n">buffer1</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">StringBuffer</span><span class="o">();</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="mi">16</span><span class="o">;</span> <span class="n">index</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">buffer1</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">a</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="n">index</span> <span class="o">*</span> <span class="mi">4</span><span class="o">,</span> <span class="n">index</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">+</span> <span class="mi">4</span><span class="o">)</span> <span class="o">+</span> <span class="s">" "</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">buffer1</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>
    <span class="o">}</span>
</pre></table></code></div></div><h3 id="4-short">4. short</h3><ol><li>16位，有符号<li>最大值2<sup>15</sup>-1,最小值-2<sup>15</sup><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">short</span>   <span class="no">MIN_VALUE</span> <span class="o">=</span> <span class="o">-</span><span class="mi">32768</span><span class="o">;</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">short</span>   <span class="no">MAX_VALUE</span> <span class="o">=</span> <span class="mi">32767</span><span class="o">;</span>
</pre></table></code></div></div><h4 id="把short类型通过byte保存">把short类型通过byte保存</h4><p>思路和之前如出一辙，代码如下</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre> <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
     <span class="kt">short</span> <span class="n">s</span> <span class="o">=</span> <span class="o">-</span><span class="mi">11117</span><span class="o">;</span>
     <span class="kt">byte</span><span class="o">[]</span> <span class="n">buff</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="mi">2</span><span class="o">];</span>
     <span class="n">buff</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="o">=</span> <span class="o">(</span><span class="kt">byte</span><span class="o">)</span> <span class="n">s</span><span class="o">;</span>
     <span class="n">buff</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span> <span class="o">=</span> <span class="o">(</span><span class="kt">byte</span><span class="o">)</span> <span class="o">(</span><span class="n">s</span><span class="o">&gt;&gt;</span><span class="mi">8</span><span class="o">);</span>
     <span class="kt">short</span> <span class="n">s1</span> <span class="o">=</span> <span class="o">(</span><span class="kt">short</span><span class="o">)</span> <span class="o">(</span><span class="n">buff</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="o">&amp;(</span><span class="kt">short</span><span class="o">)</span><span class="mh">0xff</span><span class="o">)</span> <span class="o">;</span>
     <span class="kt">short</span> <span class="n">s2</span> <span class="o">=</span>  <span class="o">(</span><span class="kt">short</span><span class="o">)</span> <span class="o">((</span><span class="n">buff</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span> <span class="o">&amp;</span> <span class="o">(</span><span class="kt">short</span><span class="o">)</span><span class="mh">0xff</span><span class="o">)</span> <span class="o">&lt;&lt;</span><span class="mi">8</span><span class="o">);</span>
     <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">s1</span><span class="o">+</span><span class="n">s2</span><span class="o">);</span>
 <span class="o">}</span>
</pre></table></code></div></div></ol><p>在整类型之间的转换的思路都是差不多的，位数大的转成位数小的，都是截取低位后再右移动，而位数小的还原位数大的，就要记得保持补码的一致性</p><h3 id="5-float和double">5. float和double</h3><h4 id="float">float</h4><ol><li>单精度,32位,符合IEEE754标准的浮点数<div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">float</span> <span class="no">MAX_VALUE</span> <span class="o">=</span> <span class="mh">0x1</span><span class="o">.</span><span class="na">fffffeP</span><span class="o">+</span><span class="mi">127</span><span class="n">f</span><span class="o">;</span> <span class="c1">// 3.4028235e+38f</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">float</span> <span class="no">MIN_VALUE</span> <span class="o">=</span> <span class="mh">0x0</span><span class="o">.</span><span class="mo">000002</span><span class="no">P</span><span class="o">-</span><span class="mi">126</span><span class="n">f</span><span class="o">;</span> <span class="c1">// 1.4e-45f</span>
</pre></table></code></div></div><h4 id="double">double</h4><li>是双精度,64 位,符合 IEEE754标准的浮点数<div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">double</span> <span class="no">MAX_VALUE</span> <span class="o">=</span> <span class="mh">0x1</span><span class="o">.</span><span class="na">fffffffffffffP</span><span class="o">+</span><span class="mi">1023</span><span class="o">;</span> <span class="c1">// 1.7976931348623157e+308</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">double</span> <span class="no">MIN_VALUE</span> <span class="o">=</span> <span class="mh">0x0</span><span class="o">.</span><span class="mo">0000000000001</span><span class="no">P</span><span class="o">-</span><span class="mi">1022</span><span class="o">;</span> <span class="c1">// 4.9e-324</span>
</pre></table></code></div></div><h4 id="float和double都是可能会丢失精度的">float和double都是可能会丢失精度的</h4><p>丢失精度的问题先要提到讲十进制和二进制之间的转换，整数部分不影响精度丢失问题，问题的关键在于小数部分 例如0.625转成二进制(注意：是从上往下取)</p></ol><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>0.625 * 2 = 1.25 -- 1
0.25 * 2 = 0.50 -- 0 
0.5 * 2 = 1.0  -- 1
</pre></table></code></div></div><p>那么十进制0.625的二进制为0.101 再举例0.62</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>0.62 * 2 = 1.24 -- 1
0.24 * 2 = 0.48 -- 0
0.48 * 2 = 0.96 -- 0
0.96 * 2 = 1.92 -- 1
0.92 * 2 = 1.84 -- 1
...
</pre></table></code></div></div><p>十进制0.62转成二进制后0.10011110101110000101000111101011100001010001111011是个无穷的，那么就会有丢弃尾部，肯定就和原来不一致，导致精度丢了</p><p>计算机中用IEEE754标准来表示小数，但IEEE754并没有解决小数无法精确表示的问题 float的二进制用科学计数法表示，即float f=1.m*2^n ， float在内存中是32位，4字节，其中最高位是符号位，1到8是指数位n，剩下的9到31是数值位m</p><div class="table-wrapper"><table><thead><tr><th> <th>符号位<th>指数位n<th>数值位m<tbody><tr><td>单精度float<td>0<td>1~8<td>9~31<tr><td>单精度double<td>0<td>1~11<td>12~63</table></div><h4 id="float和double在内存中的二进制数">float和double在内存中的二进制数</h4><p>例如<code class="language-plaintext highlighter-rouge">float f=8.25f;</code>，先8.25转成二进制，整数部分为1000，小数部分为0.01，整体为1000.01，科学计数法1.00001*2^3,小数点后的00001就是数值位</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>0000 1000 0000 0000 0000 000
</pre></table></code></div></div><p>指数是3，不过这里不能直接把3转成二进制填入指数位，而是要用位移存储,需要把n+127再转成二进制放入指数位</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>3+127 -&gt; 1000 0010
</pre></table></code></div></div><p>8.25f在内存中表示为</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>0 1000 0010 0000 1000 0000 0000 0000 000
</pre></table></code></div></div><p>java代码验证</p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="kt">float</span> <span class="n">f</span> <span class="o">=</span> <span class="mf">8.25f</span><span class="o">;</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="nc">Integer</span><span class="o">.</span><span class="na">toBinaryString</span><span class="o">(</span><span class="nc">Float</span><span class="o">.</span><span class="na">floatToIntBits</span><span class="o">(</span><span class="n">f</span><span class="o">)));</span>
<span class="o">}</span>
</pre></table></code></div></div><p>主要是Float.floatToIntBits，floatToIntBits这就是把float的IEEE754格式的二进制看成int的，再直接用Integer.toBinaryString转成二进制就得到了float在内存的二进制</p><p>其实用cpp来说明会更加直接好理解，先定义一个共用体，包含成员float f和unsigned int i，共用体允许在相同的内存位置存储不同的数据类型，也就是说f和i的内存地址是一样的，而float和int都是32位，那么先对f赋值，内存里保存的就是f的二进制，那么就可以通过i直接右移后&amp;1截取最低位，再按照顺序打印出来即可</p><div class="language-cpp highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="cp">#include</span><span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
  
<span class="k">union</span> <span class="n">ufloat</span><span class="p">{</span>
    <span class="kt">float</span> <span class="n">f</span><span class="p">;</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
<span class="p">};</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
  <span class="n">ufloat</span> <span class="n">u</span><span class="p">;</span>
  <span class="n">u</span><span class="p">.</span><span class="n">f</span> <span class="o">=</span> <span class="mf">8.25f</span><span class="p">;</span>
  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">"u.i=%u</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span><span class="n">u</span><span class="p">.</span><span class="n">i</span><span class="p">);</span>
  <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">index</span><span class="o">=</span><span class="mi">31</span><span class="p">;</span><span class="n">index</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">;</span><span class="n">index</span><span class="o">--</span><span class="p">){</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">out</span> <span class="o">=</span> <span class="p">(</span> <span class="n">u</span><span class="p">.</span><span class="n">i</span> <span class="o">&gt;&gt;</span> <span class="n">index</span> <span class="p">)</span> <span class="o">&amp;</span> <span class="n">i</span><span class="p">;</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"%d"</span><span class="p">,</span><span class="n">out</span><span class="p">);</span> 
  <span class="p">}</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><p>例如<code class="language-plaintext highlighter-rouge">double d = 89.125;</code>,整数部分89的二进制1011001，小数部分0.001，合起来为1011001.001，IEEE754标准的科学计数法表示为1.011001001*2^6</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>0.125 * 2 = 0.250 -- 0
0.250 * 2 = 0.5 -- 0
0.5 * 2 = 1.0 -- 1
```‬
</pre></table></code></div></div><p>符号位为0，指数为1023+6=1029–&gt;10000000101,数值位011001001后面补0足到52位</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>0 10000000101 011001001....
</pre></table></code></div></div><p>在cpp上和float一样的思路，代码如下，因为double是64位，所以选择了同样是64位的long来更方便的读取</p><div class="language-cpp highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre><span class="cp">#include</span><span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>

<span class="k">union</span> <span class="n">ddouble</span><span class="p">{</span>
    <span class="kt">double</span> <span class="n">d</span><span class="p">;</span>
    <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">l</span><span class="p">;</span>
<span class="p">};</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="n">ddouble</span> <span class="n">t</span><span class="p">;</span>
    <span class="n">t</span><span class="p">.</span><span class="n">d</span> <span class="o">=</span> <span class="mf">89.125</span><span class="p">;</span>
    <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">os</span><span class="o">=</span><span class="mi">1l</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">index</span><span class="o">=</span><span class="mi">63</span><span class="p">;</span><span class="n">index</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">;</span><span class="n">index</span><span class="o">--</span><span class="p">){</span>
        <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">out</span> <span class="o">=</span> <span class="p">(</span> <span class="n">t</span><span class="p">.</span><span class="n">l</span> <span class="o">&gt;&gt;</span> <span class="n">index</span> <span class="p">)</span> <span class="o">&amp;</span> <span class="n">os</span><span class="p">;</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">"%d "</span><span class="p">,</span><span class="n">out</span><span class="p">);</span> 
    <span class="p">}</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><h3 id="6-char">6. char</h3><ol><li>char在java1.8中16位，2字节<div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">char</span> <span class="no">MIN_VALUE</span> <span class="o">=</span> <span class="sc">'\u0000'</span><span class="o">;</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">char</span> <span class="no">MAX_VALUE</span> <span class="o">=</span> <span class="err">'\</span><span class="n">uFFFF</span><span class="err">'</span><span class="o">;</span>
</pre></table></code></div></div></ol><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="kt">char</span> <span class="n">c</span> <span class="o">=</span> <span class="sc">'A'</span><span class="o">;</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">c</span><span class="o">);</span>
<span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">c</span> <span class="o">&amp;</span> <span class="mh">0xffff</span><span class="o">;</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="nc">Integer</span><span class="o">.</span><span class="na">toBinaryString</span><span class="o">(</span><span class="n">i</span><span class="o">));</span>
</pre></table></code></div></div><p>其实char就是保存的ASCII码，可以直接强转成int，打印出来就是在内存的存储</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/java/'>java</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/java/" class="post-tag no-text-decoration" >java</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/ThreadLocal/">ThreadLocal分析</a><li><a href="/posts/Android_Zxing/">关于Android Zxing 3.3.0 的填坑</a><li><a href="/posts/Server_Config_Tomcat_Nginx/">服务器应用的配置小记录笔记</a><li><a href="/posts/Server_Config_Nginx_Gunicorn_django/">Nginx + Gunicorn + Django 部署</a><li><a href="/posts/Android_Framework_Start_Animation/">Android系统-修改开机动画</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/android/">Android</a> <a class="post-tag" href="/tags/handler/">Handler</a> <a class="post-tag" href="/tags/framework/">Framework</a> <a class="post-tag" href="/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/">动态规划</a> <a class="post-tag" href="/tags/messagequeue/">MessageQueue</a> <a class="post-tag" href="/tags/c-c/">C/C++</a> <a class="post-tag" href="/tags/nginx/">Nginx</a> <a class="post-tag" href="/tags/androidautosize/">AndroidAutoSize</a> <a class="post-tag" href="/tags/django/">Django</a> <a class="post-tag" href="/tags/gunicorn/">Gunicorn</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Android-CEC-1/"><div class="card-body"> <span class="timeago small" > Nov 18, 2024 <i class="unloaded">2024-11-18T22:34:09+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HDMI CEC (1)</h3><div class="text-muted small"><p> 前言 以下分析基于android14 CEC（Consumer Electronics Control）信号通过13引脚传输，作为HDMI接口的一部分。CEC总线作为控制信号被分离出来，使得在不增加数据占用宽带的情况下完成高速复杂的通信要求 这优先分析一下，是怎么和cec设备通信的，也就是收发的过程 HdmiControlService frameworks/base/se...</p></div></div></a></div><div class="card"> <a href="/posts/dp-diff-path/"><div class="card-body"> <span class="timeago small" > Jun 13, 2024 <i class="unloaded">2024-06-13T22:56:28+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>不同路径</h3><div class="text-muted small"><p> 不同路径1 从一个m*n网格的最左上角开始，每次只能向下或者向右移动一步，试图达到网格的最右下角，问：共有多少条不同的路？ 从上的网格来看，水平方向为i，竖直方向为j，到格子(i,j)的位置的路线是由正上方（i,j-1）和左边的（i-1，j）的和 确定dp数组以及下标的定义 (0,0)是起点，（i,j）是终点，dp[i][j]从(0,0)到(i,j)有多少条...</p></div></div></a></div><div class="card"> <a href="/posts/dumpsys/"><div class="card-body"> <span class="timeago small" > Apr 11, 2024 <i class="unloaded">2024-04-11T23:39:08+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>dumpsys源码流程分析</h3><div class="text-muted small"><p> 1.源码入口 frameworks/native/cmds/dumpsys/main.cpp 1 2 3 4 5 6 7 8 9 10 11 12 int main(int argc, char* const argv[]) { signal(SIGPIPE, SIG_IGN); sp&lt;IServiceManager&gt; sm = defaultServiceMa...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/dp-all-package/" class="btn btn-outline-primary" prompt="Older"><p>完全背包</p></a> <a href="/posts/Handler-native/" class="btn btn-outline-primary" prompt="Newer"><p>MessageQueue的Native方法分析</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://github.com/kkyflying">kky</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/android/">Android</a> <a class="post-tag" href="/tags/handler/">Handler</a> <a class="post-tag" href="/tags/framework/">Framework</a> <a class="post-tag" href="/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/">动态规划</a> <a class="post-tag" href="/tags/messagequeue/">MessageQueue</a> <a class="post-tag" href="/tags/c-c/">C/C++</a> <a class="post-tag" href="/tags/nginx/">Nginx</a> <a class="post-tag" href="/tags/androidautosize/">AndroidAutoSize</a> <a class="post-tag" href="/tags/django/">Django</a> <a class="post-tag" href="/tags/gunicorn/">Gunicorn</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><script src="https://cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js"></script> <script> $(function() { let initTheme = "default"; if ($("html[mode=dark]").length > 0 || ($("html[mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches ) ) { initTheme = "dark"; } let mermaidConf = { theme: initTheme /* <default|dark|forest|neutral> */ }; /* Markdown converts to HTML */ $("pre").has("code.language-mermaid").each(function() { let svgCode = $(this).children().html(); $(this).addClass("unloaded"); $(this).after(`<div class=\"mermaid\">${svgCode}</div>`); }); mermaid.initialize(mermaidConf); }); </script><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://kkyflying.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
